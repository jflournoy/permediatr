You probably need to do the permutation confidence interval and then center it at the mean to get a null distribution.
simulate:

```{r}
library(permediatr)
rez = replicate(100, {
adf <- simulate_mediation_data(J = 100, n_j = 4, a = 0, b = 0, c_p = 0)
adf <- dplyr::mutate(
  dplyr::group_by(
    dplyr::mutate(adf, x_mean = mean(x), m_mean = mean(m)), 
    id),
  x_bc = mean(x) - x_mean,
  x_wc = x - x_bc - x_mean,
  m_bc = mean(m) - m_mean,
  m_wc = m - m_bc - m_mean)

ab <- indirect_within.lme4(data = adf, 
                           indices.y = NULL, 
                           indices.m = NULL, 
                           y.name = 'y',
                           x.name = 'x_wc',
                           m_b.name = 'm_wc',
                           m_a.name = 'm',
                           group.id = 'id',
                           covariates.y=c('cov.y', 'm_bc', 'x_bc'),
                           covariates.m=c('cov.m', 'x_bc'),
                           random.a=T,
                           random.b=T,
                           random.c_p=T, optimizer = "bobyqa")
perms.y <- permute_within(n = 1e3, data = adf, group.id = 'id', series = F)
perms.m <- permute_within(n = 1e3, data = adf, group.id = 'id', series = F)
perms_list.y <- lapply(seq_len(nrow(perms.y)), function(i) perms[i,])
perms_list.m <- lapply(seq_len(nrow(perms.m)), function(i) perms[i,])
ncores = 7
split_perms_list.y <- split(perms_list.y, 1:ncores)
split_perms_list.m <- split(perms_list.m, 1:ncores)
system.time({
  ab_perms <- parallel::mcmapply(function(perm_list.y, perm_list.m){
    mapply(function(indices.y, indices.m){
      ab <- indirect_within.lme4(data = adf, 
                                indices.y = indices.y,
                                indices.m = indices.m,
                                y.name = 'y',
                                x.name = 'x_wc',
                                m_b.name = 'm_wc',
                                m_a.name = 'm',
                                group.id = 'id',
                                covariates.y=c('cov.y', 'm_bc', 'x_bc'),
                                covariates.m=c('cov.m', 'x_bc'),
                                random.a=T,
                                random.b=T,
                                random.c_p=T, 
                                optimizer = "bobyqa")
    }, perm_list.y, perm_list.m, SIMPLIFY = FALSE)
  }, split_perms_list.y, split_perms_list.m, SIMPLIFY = FALSE, mc.cores = ncores)
})
ab_vec <- unlist(lapply(unlist(ab_perms, recursive = F), `[[`, 'ab'))
warnings <- unlist(lapply(unlist(ab_perms, recursive = F), `[[`, 'warnings'))
})

hist(rez, breaks = 25)

mean(ab_vec)
ab
lim <- max(abs(c(ab$ab, ab_vec)))
hist(unlist(ab_vec), breaks = 100, xlim = c(-lim, lim))
abline(v = ab$ab, col = 'blue')
hist(ab_vec - ab$ab, breaks = 100, xlim = c(-lim, lim))
abline(v = ab$ab, col = 'blue')
plot(ecdf(scale(ab_vec)))
lines(sort(scale(ab_vec)), pnorm(sort(scale(ab_vec))), col = 'red')
```
