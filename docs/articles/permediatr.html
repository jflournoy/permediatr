<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Error rate of permutation and bootstrap methods • permediatr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Error rate of permutation and bootstrap methods">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">permediatr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/permediatr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/testing.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="permediatr_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="permediatr_files/jquery-1.12.4/jquery.min.js"></script><link href="permediatr_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="permediatr_files/datatables-binding-0.5/datatables.js"></script><link href="permediatr_files/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="permediatr_files/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="permediatr_files/dt-core-1.10.16/js/jquery.dataTables.min.js"></script><link href="permediatr_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="permediatr_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Error rate of permutation and bootstrap methods</h1>
                        <h4 class="author">John Flournoy</h4>
            
            <h4 class="date">2019-11-25</h4>
      
      
      <div class="hidden name"><code>permediatr.Rmd</code></div>

    </div>

    
    
<p>The output from the simulations needs to be collected first from the csv output. Another aspect of the output is that each simulation gives the p-value of the indirect path as just the cumulative probability. We want to reject the null for any indirect path where that is either &lt; .025 or &gt; .975. I’ll summarize the output to look at the error rate (any null rejection) for each subset of simulation input (a path, b path, and c_p path). There are three ways I could imagine getting a p-value from the permutation-generated confidence interval – first, subtracting the mean of all permutations, to center the CI around 0, <code>p_ab_perm_mean_c</code>; second, centering that distribution around the model-estimated a*b path, <code>p_ab_perm_ab_c</code>; and third, taking the proportion of the CI that is below 0. In the final case, to keep the test two-sided, we reject the null when &gt; .025 proportion of the tail is of the sign opposite the indirect effect estimate.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(permediatr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">proportion_fp &lt;-<span class="st"> </span><span class="cf">function</span>(p, <span class="dt">alpha =</span> <span class="fl">.05</span>) {</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  left &lt;-<span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  right &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  p_fp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(p <span class="op">&lt;</span><span class="st"> </span>left) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(p <span class="op">&gt;</span><span class="st"> </span>right)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  p_se &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>( (p_fp <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_fp)) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(p) )</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  u<span class="fl">.975</span> &lt;-<span class="st"> </span>p_fp <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>p_se</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  l<span class="fl">.025</span> &lt;-<span class="st"> </span>p_fp <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>p_se</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_fp =</span> p_fp, <span class="dt">l.025 =</span> l<span class="fl">.025</span>, <span class="dt">u.975 =</span> u<span class="fl">.975</span>))</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">bias_ci &lt;-<span class="st"> </span><span class="cf">function</span>(v){</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  bias &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(v)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  se &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(v)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(v))</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  u &lt;-<span class="st"> </span>bias <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  l &lt;-<span class="st"> </span>bias <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">bias =</span> bias, <span class="dt">l.025 =</span> l, <span class="dt">u.975 =</span> u))</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">perm_file_list &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">dir</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">'csv'</span>, <span class="dt">package =</span> <span class="st">'permediatr'</span>), </a>
<a class="sourceLine" id="cb1-21" data-line-number="21">                      <span class="dt">pattern =</span> <span class="st">'pmjob.*csv'</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">perm_sim_results &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(perm_file_list, data.table<span class="op">::</span>fread), <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw"><a href="https://Rdatatable.gitlab.io/data.table/reference/assign.html">set</a></span>(perm_sim_results, <span class="dt">i =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(perm_sim_results[[<span class="st">'permtype'</span>]])), <span class="dt">j =</span> <span class="st">'permtype'</span>, <span class="st">'within'</span>)</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">perm_sim_results[, a_or_b_size <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(a,b)]</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">perm_sim_bias_summary &lt;-<span class="st"> </span>perm_sim_results[, <span class="kw">bias_ci</span>(ab <span class="op">-</span><span class="st"> </span>mean_ab_perm),</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">                                          by =<span class="st"> </span>.(a_or_b_size, c_p, reform, permtype)]</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">perm_sim_results_l &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">melt</span>(perm_sim_results, </a>
<a class="sourceLine" id="cb1-28" data-line-number="28">                                       <span class="dt">id.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'a_or_b_size'</span>, <span class="st">'c_p'</span>, <span class="st">'reform'</span>, <span class="st">'permtype'</span>),</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">                                       <span class="dt">measure.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">'p_'</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(perm_sim_results), <span class="dt">value =</span> T), </a>
<a class="sourceLine" id="cb1-30" data-line-number="30">                                       <span class="dt">value.name =</span> <span class="st">'p'</span>)</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">perm_sim_results_summary_l &lt;-<span class="st"> </span>perm_sim_results_l[, </a>
<a class="sourceLine" id="cb1-32" data-line-number="32">                                                 <span class="kw">proportion_fp</span>(p), </a>
<a class="sourceLine" id="cb1-33" data-line-number="33">                                                 by =<span class="st"> </span>.(variable, a_or_b_size, c_p, reform, permtype)]</a></code></pre></div>
<div id="permutation-sim-results" class="section level1 tabset">
<h1 class="hasAnchor">
<a href="#permutation-sim-results" class="anchor"></a>Permutation Sim Results</h1>
<div id="null-within" class="section level2">
<h2 class="hasAnchor">
<a href="#null-within" class="anchor"></a>NULL within</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(perm_sim_results_summary_l[reform <span class="op">==</span><span class="st"> 'NULL'</span> <span class="op">&amp;</span><span class="st"> </span>permtype <span class="op">==</span><span class="st"> 'within'</span>], </a>
<a class="sourceLine" id="cb2-2" data-line-number="2">       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> a_or_b_size, <span class="dt">y =</span> p_fp, <span class="dt">group =</span> c_p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">linetype =</span> <span class="st">'dotted'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> l<span class="fl">.025</span>, <span class="dt">ymax =</span> u<span class="fl">.975</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(c_p)), <span class="dt">alpha =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">'reform = NULL, permutations = within'</span>,</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">'Size of largest non-zero path (a or b)'</span>,</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">'Proportion false positive</span><span class="ch">\n</span><span class="st">(95% CI)'</span>)</a></code></pre></div>
<p><img src="permediatr_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="na-within" class="section level2">
<h2 class="hasAnchor">
<a href="#na-within" class="anchor"></a>NA within</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(perm_sim_results_summary_l[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(reform) <span class="op">&amp;</span><span class="st"> </span>permtype <span class="op">==</span><span class="st"> 'within'</span>], </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> a_or_b_size, <span class="dt">y =</span> p_fp, <span class="dt">group =</span> c_p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">linetype =</span> <span class="st">'dotted'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> l<span class="fl">.025</span>, <span class="dt">ymax =</span> u<span class="fl">.975</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(c_p)), <span class="dt">alpha =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">'reform = NA, permutations = within'</span>,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">'Size of largest non-zero path (a or b)'</span>,</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">'Proportion false positive</span><span class="ch">\n</span><span class="st">(95% CI)'</span>)</a></code></pre></div>
<p><img src="permediatr_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
<div id="na-bwwithin" class="section level2">
<h2 class="hasAnchor">
<a href="#na-bwwithin" class="anchor"></a>NA bw/within</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(perm_sim_results_summary_l[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(reform) <span class="op">&amp;</span><span class="st"> </span>permtype <span class="op">==</span><span class="st"> 'between_within'</span>], </a>
<a class="sourceLine" id="cb4-2" data-line-number="2">       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> a_or_b_size, <span class="dt">y =</span> p_fp, <span class="dt">group =</span> c_p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">linetype =</span> <span class="st">'dotted'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> l<span class="fl">.025</span>, <span class="dt">ymax =</span> u<span class="fl">.975</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(c_p)), <span class="dt">alpha =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">'reform = NA, permutations = betwee_within'</span>,</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">'Size of largest non-zero path (a or b)'</span>,</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">'Proportion false positive</span><span class="ch">\n</span><span class="st">(95% CI)'</span>)</a></code></pre></div>
<p><img src="permediatr_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="table-of-fps" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-fps" class="anchor"></a>Table of FPs</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/datatable">datatable</a></span>(perm_sim_results_summary_l)</a></code></pre></div>
<div id="htmlwidget-7881a1af769b18643b00" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7881a1af769b18643b00">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120"],["p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_ab","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_c_mean","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_ab","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_neg_c_mean","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci"],[0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8],[0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8],["NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null],["within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within"],[0.432,0.474,0.335,0.512,0.466,0.32,0.826,0.672,0.344,0.838,0.648,0.326,0.496,0.461,0.36,0.46,0.431,0.334,0.828,0.689,0.3,0.814,0.643,0.302,0.246,0.325,0.309,0.274,0.309,0.278,0.672,0.451,0.26,0.734,0.452,0.268,0.316,0.304,0.338,0.262,0.294,0.302,0.674,0.462,0.217,0.672,0.452,0.241,0.058,0.186,0.296,0.084,0.155,0.286,0.054,0.2,0.244,0.052,0.193,0.246,0.092,0.164,0.329,0.054,0.178,0.262,0.06,0.231,0.195,0.03,0.218,0.224,0.272,0.345,0.308,0.304,0.327,0.282,0.702,0.486,0.272,0.734,0.469,0.272,0.334,0.325,0.34,0.294,0.316,0.302,0.688,0.474,0.23,0.684,0.477,0.245,0.058,0.186,0.296,0.084,0.155,0.286,0.054,0.2,0.244,0.052,0.193,0.246,0.092,0.164,0.329,0.054,0.178,0.262,0.06,0.231,0.195,0.03,0.218,0.224],[0.388580270806925,0.44305160620646,0.305745727833357,0.468185691615638,0.435081411571677,0.279111562514569,0.792769588675432,0.6429010291316,0.302360815992625,0.805703862472426,0.618398419069246,0.28491249050137,0.45217447012528,0.430104095313456,0.330249291773136,0.416313538939392,0.400306187229345,0.292658958155363,0.794921145557925,0.660308987358408,0.271596901577469,0.779893296658868,0.613304156492869,0.2735431218578,0.20824936200804,0.295969826042547,0.280359912877228,0.234905590210364,0.280359912877228,0.238729894688198,0.630847840746809,0.420158853484347,0.22155201331669,0.695268892337037,0.421152812873781,0.229176560646949,0.275248587990108,0.27548998256051,0.308681387317951,0.223456611212816,0.265762120079581,0.261755896988503,0.63291249050137,0.43109930859026,0.191451416916001,0.630847840746809,0.421152812873781,0.214491480041315,0.0375114833333401,0.161882918783568,0.267706396934996,0.0596858859754257,0.132568915318246,0.246390150558226,0.0341886752386419,0.17520774314428,0.206353302869973,0.032538473153424,0.168539152884661,0.20824936200804,0.0666657584443505,0.141050082213655,0.299878396774903,0.0341886752386419,0.154291614445517,0.223456611212816,0.0391833605017525,0.204876868824737,0.170443225781874,0.0150473707997556,0.192408974197973,0.198158903305007,0.232994916597961,0.315536368859219,0.279385611004252,0.26368074667358,0.297923811226366,0.242558098382558,0.66190891985491,0.455021829518191,0.232994916597961,0.695268892337037,0.438069299678151,0.232994916597961,0.292658958155363,0.295969826042547,0.310639226168236,0.254065607243881,0.287184400224878,0.261755896988503,0.647389102703831,0.44305160620646,0.203916530905572,0.643248587990108,0.446042484053141,0.218342919139561,0.0375114833333401,0.161882918783568,0.267706396934996,0.0596858859754257,0.132568915318246,0.246390150558226,0.0341886752386419,0.17520774314428,0.206353302869973,0.032538473153424,0.168539152884661,0.20824936200804,0.0666657584443505,0.141050082213655,0.299878396774903,0.0341886752386419,0.154291614445517,0.223456611212816,0.0391833605017525,0.204876868824737,0.170443225781874,0.0150473707997556,0.192408974197973,0.198158903305007],[0.475419729193075,0.50494839379354,0.364254272166643,0.555814308384362,0.496918588428322,0.360888437485431,0.859230411324568,0.7010989708684,0.385639184007375,0.870296137527574,0.677601580930754,0.36708750949863,0.53982552987472,0.491895904686544,0.389750708226864,0.503686461060608,0.461693812770655,0.375341041844637,0.861078854442075,0.717691012641592,0.328403098422531,0.848106703341132,0.672695843507131,0.3304568781422,0.28375063799196,0.354030173957453,0.337640087122772,0.313094409789636,0.337640087122772,0.317270105311802,0.713152159253191,0.481841146515653,0.29844798668331,0.772731107662963,0.482847187126219,0.306823439353051,0.356751412009892,0.33251001743949,0.367318612682049,0.300543388787184,0.322237879920419,0.342244103011497,0.71508750949863,0.49290069140974,0.242548583083999,0.713152159253191,0.482847187126219,0.267508519958685,0.0784885166666599,0.210117081216432,0.324293603065004,0.108314114024574,0.177431084681754,0.325609849441774,0.0738113247613581,0.22479225685572,0.281646697130027,0.071461526846576,0.217460847115339,0.28375063799196,0.11733424155565,0.186949917786345,0.358121603225097,0.0738113247613581,0.201708385554483,0.300543388787184,0.0808166394982475,0.257123131175263,0.219556774218126,0.0449526292002443,0.243591025802027,0.249841096694993,0.311005083402039,0.374463631140781,0.336614388995748,0.34431925332642,0.356076188773634,0.321441901617442,0.74209108014509,0.516978170481809,0.311005083402039,0.772731107662963,0.499930700321848,0.311005083402039,0.375341041844637,0.354030173957453,0.369360773831764,0.333934392756119,0.344815599775122,0.342244103011497,0.728610897296169,0.50494839379354,0.256083469094428,0.724751412009892,0.507957515946859,0.271657080860439,0.0784885166666599,0.210117081216432,0.324293603065004,0.108314114024574,0.177431084681754,0.325609849441774,0.0738113247613581,0.22479225685572,0.281646697130027,0.071461526846576,0.217460847115339,0.28375063799196,0.11733424155565,0.186949917786345,0.358121603225097,0.0738113247613581,0.201708385554483,0.300543388787184,0.0808166394982475,0.257123131175263,0.219556774218126,0.0449526292002443,0.243591025802027,0.249841096694993]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>a_or_b_size<\/th>\n      <th>c_p<\/th>\n      <th>reform<\/th>\n      <th>permtype<\/th>\n      <th>p_fp<\/th>\n      <th>l.025<\/th>\n      <th>u.975<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="table-of-bias" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-bias" class="anchor"></a>Table of Bias</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/datatable">datatable</a></span>(perm_sim_bias_summary)</a></code></pre></div>
<div id="htmlwidget-14ae39f9b4b1a761996b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-14ae39f9b4b1a761996b">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],[0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8],[0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8],["NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null,"NULL","NULL","NULL","NULL","NULL","NULL",null,null,null,null,null,null],["within","within","within","within","within","within","within","within","within","within","within","within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within","between_within"],[-7.63762953459247e-06,-0.000275482711756168,7.3882372182848e-05,-7.10558167551067e-05,0.000311953804305447,-2.26503878575531e-05,0.000910441408234409,0.000271055226910483,7.26268975064107e-05,-5.67327980279355e-05,-0.000238194453942862,-0.000511902292359739,-4.38290877094936e-05,-3.72040687418582e-05,-5.21534214324376e-05,0.000104601777845177,-9.11169757424596e-05,-0.000314707196918844,0.000321813983473833,-9.59885344353846e-05,-0.000925535221687051,0.000560531347682918,0.000117804426061634,0.000574380291827851],[-0.000842150106810071,-0.000891147810625423,-0.000594830218299899,-0.000957886636633295,-0.000287684195966219,-0.00104193606957738,-0.000533924132773961,-0.000858810477817379,-0.0014556210997369,-0.00158429114904403,-0.00132764970747942,-0.00210445071965628,-0.000900878970227626,-0.000633751127349653,-0.000750878370969144,-0.000729537225428637,-0.000705772339086672,-0.00132681285451864,-0.00118474984899093,-0.00119878345161865,-0.00207714688080398,-0.000882042214901795,-0.000970878697393706,-0.000523930616150407],[0.000826874847740887,0.000340182387113088,0.000742594962665595,0.000815775003123082,0.000911591804577113,0.000996635293862278,0.00235480694924278,0.00140092093163834,0.00160087489474972,0.00147082555298816,0.000851260799593691,0.0010806461349368,0.000813220794808639,0.000559342989865937,0.000646571528104269,0.000938740781118991,0.000523538387601753,0.000697398460680951,0.0018283778159386,0.00100680638274788,0.000226076437429883,0.00200310491026763,0.00120648754951697,0.00167269119980611]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>a_or_b_size<\/th>\n      <th>c_p<\/th>\n      <th>reform<\/th>\n      <th>permtype<\/th>\n      <th>bias<\/th>\n      <th>l.025<\/th>\n      <th>u.975<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="bootstrap-sim-results" class="section level1 tabset">
<h1 class="hasAnchor">
<a href="#bootstrap-sim-results" class="anchor"></a>Bootstrap Sim Results</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">boot_file_list &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">dir</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">'csv'</span>, <span class="dt">package =</span> <span class="st">'permediatr'</span>), </a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                      <span class="dt">pattern =</span> <span class="st">'boot.*csv'</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">boot_sim_results &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(boot_file_list, data.table<span class="op">::</span>fread), <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">boot_sim_results[, a_or_b_size <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">pmax</a></span>(a,b)]</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">boot_sim_bias_summary &lt;-<span class="st"> </span>boot_sim_results[, <span class="kw">bias_ci</span>(ab <span class="op">-</span><span class="st"> </span>boot_ab),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                                          by =<span class="st"> </span>.(a_or_b_size, c_p, reform, boottype)]</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">boot_sim_results_l &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">melt</span>(boot_sim_results, </a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                                       <span class="dt">id.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'a_or_b_size'</span>, <span class="st">'c_p'</span>, <span class="st">'reform'</span>, <span class="st">'boottype'</span>),</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">                                       <span class="dt">measure.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep</a></span>(<span class="st">'p_'</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(boot_sim_results), <span class="dt">value =</span> T), </a>
<a class="sourceLine" id="cb7-10" data-line-number="10">                                       <span class="dt">value.name =</span> <span class="st">'p'</span>)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">boot_sim_results_summary_l &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">  </span>boot_sim_results_l[, <span class="kw">proportion_fp</span>(p), </a>
<a class="sourceLine" id="cb7-13" data-line-number="13">              by =<span class="st"> </span>.(variable, a_or_b_size, c_p, reform, boottype)]</a></code></pre></div>
<div id="na-parametric" class="section level2">
<h2 class="hasAnchor">
<a href="#na-parametric" class="anchor"></a>NA parametric</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(boot_sim_results_summary_l, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> a_or_b_size, <span class="dt">y =</span> p_fp, <span class="dt">group =</span> c_p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="dt">yintercept =</span> <span class="fl">.05</span>, <span class="dt">linetype =</span> <span class="st">'dotted'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> l<span class="fl">.025</span>, <span class="dt">ymax =</span> u<span class="fl">.975</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(c_p)), <span class="dt">alpha =</span> <span class="fl">.5</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">001</span>, <span class="fl">.05</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">trans =</span> scales<span class="op">::</span><span class="kw"><a href="https://scales.r-lib.org//reference/boxcox_trans.html">modulus_trans</a></span>(<span class="op">-</span><span class="dv">7</span>, <span class="dt">offset =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.0001</span>,.<span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">'reform = NA, boottype = parametric'</span>,</a>
<a class="sourceLine" id="cb8-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">'Size of largest non-zero path (a or b)'</span>,</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">'Proportion false positive</span><span class="ch">\n</span><span class="st">(95% CI)'</span>)</a></code></pre></div>
<p><img src="permediatr_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="table-of-fps-1" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-fps-1" class="anchor"></a>Table of FPs</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/datatable">datatable</a></span>(boot_sim_results_summary_l)</a></code></pre></div>
<div id="htmlwidget-7cab47f93502e9f0ffc0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7cab47f93502e9f0ffc0">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54"],["p_ab_c_ab","p_ab_c_ab","p_ab_c_ab","p_ab_c_ab","p_ab_c_ab","p_ab_c_ab","p_ab_c_mean","p_ab_c_mean","p_ab_c_mean","p_ab_c_mean","p_ab_c_mean","p_ab_c_mean","p_ab_neg_c_ab","p_ab_neg_c_ab","p_ab_neg_c_ab","p_ab_neg_c_ab","p_ab_neg_c_ab","p_ab_neg_c_ab","p_ab_neg_c_mean","p_ab_neg_c_mean","p_ab_neg_c_mean","p_ab_neg_c_mean","p_ab_neg_c_mean","p_ab_neg_c_mean","p_boot_c_ab","p_boot_c_ab","p_boot_c_ab","p_boot_c_ab","p_boot_c_ab","p_boot_c_ab","p_boot_c_mean","p_boot_c_mean","p_boot_c_mean","p_boot_c_mean","p_boot_c_mean","p_boot_c_mean","p_boot_neg_c_ab","p_boot_neg_c_ab","p_boot_neg_c_ab","p_boot_neg_c_ab","p_boot_neg_c_ab","p_boot_neg_c_ab","p_boot_neg_c_mean","p_boot_neg_c_mean","p_boot_neg_c_mean","p_boot_neg_c_mean","p_boot_neg_c_mean","p_boot_neg_c_mean","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci","p_opsign_ci"],[0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8,0,0.2,0.8],[0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8,0,0,0,0.8,0.8,0.8],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric","parametric"],[0.29,0.238,0.09,0.304,0.247,0.086,0.042,0.029,0.053,0.034,0.041,0.039,0,0.001,0.05,0,0.002,0.035,0.048,0.039,0.055,0.04,0.05,0.048,0.042,0.029,0.053,0.034,0.041,0.039,0,0,0.047,0,0,0.032,0.04,0.046,0.064,0.046,0.047,0.057,0,0.001,0.05,0,0.002,0.035,0,0.001,0.05,0,0.002,0.035],[0.250226002463921,0.211604977560154,0.0722622707202979,0.26368074667358,0.220269810595508,0.0686228562070748,0.0244175873327919,0.0185992493347836,0.0391142610711565,0.0181145657660862,0.0287098466079548,0.0270008614309193,0,-0.000959019754877423,0.0364916322229516,0,-0.00076908533635206,0.0236092124943005,0.0292625640174543,0.0270008614309193,0.0408696369473392,0.022823420596638,0.0364916322229516,0.0347506319546931,0.0244175873327919,0.0185992493347836,0.0391142610711565,0.0181145657660862,0.0287098466079548,0.0270008614309193,0,0,0.0338824885896753,0,0,0.0210914069834832,0.022823420596638,0.0330159800369839,0.0488300558208015,0.0276378228741797,0.0338824885896753,0.0426302455970883,0,-0.000959019754877423,0.0364916322229516,0,-0.00076908533635206,0.0236092124943005,0,-0.000959019754877423,0.0364916322229516,0,-0.00076908533635206,0.0236092124943005],[0.329773997536079,0.264395022439846,0.107737729279702,0.34431925332642,0.273730189404492,0.103377143792925,0.0595824126672081,0.0394007506652164,0.0668857389288435,0.0498854342339138,0.0532901533920452,0.0509991385690807,0,0.00295901975487742,0.0635083677770484,0,0.00476908533635206,0.0463907875056995,0.0667374359825458,0.0509991385690807,0.0691303630526608,0.057176579403362,0.0635083677770484,0.0612493680453069,0.0595824126672081,0.0394007506652164,0.0668857389288435,0.0498854342339138,0.0532901533920452,0.0509991385690807,0,0,0.0601175114103247,0,0,0.0429085930165168,0.057176579403362,0.0589840199630161,0.0791699441791986,0.0643621771258203,0.0601175114103247,0.0713697544029117,0,0.00295901975487742,0.0635083677770484,0,0.00476908533635206,0.0463907875056995,0,0.00295901975487742,0.0635083677770484,0,0.00476908533635206,0.0463907875056995]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>variable<\/th>\n      <th>a_or_b_size<\/th>\n      <th>c_p<\/th>\n      <th>reform<\/th>\n      <th>boottype<\/th>\n      <th>p_fp<\/th>\n      <th>l.025<\/th>\n      <th>u.975<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="table-of-bias-1" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-bias-1" class="anchor"></a>Table of Bias</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">DT<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DT/topics/datatable">datatable</a></span>(boot_sim_bias_summary)</a></code></pre></div>
<div id="htmlwidget-a9d4d0c4b3b5e087f94c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a9d4d0c4b3b5e087f94c">{"x":{"filter":"none","data":[["1","2","3","4","5","6"],[0,0.2,0.8,0,0.2,0.8],[0,0,0,0.8,0.8,0.8],[null,null,null,null,null,null],["parametric","parametric","parametric","parametric","parametric","parametric"],[0.000315047026204216,-0.000190354260249295,0.00076023353744856,-0.000502982591534131,0.000864014540563165,-0.000488064473917302],[-0.00124171154588,-0.00128624277196173,-0.000371007086102772,-0.00208192707179082,-0.000265866376760928,-0.00159339480935565],[0.00187180559828843,0.000905534251463139,0.00189147416099989,0.00107596188872256,0.00199389545788726,0.000617265861521043]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>a_or_b_size<\/th>\n      <th>c_p<\/th>\n      <th>reform<\/th>\n      <th>boottype<\/th>\n      <th>bias<\/th>\n      <th>l.025<\/th>\n      <th>u.975<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#permutation-sim-results">Permutation Sim Results</a><ul class="nav nav-pills nav-stacked">
<li><a href="#null-within">NULL within</a></li>
      <li><a href="#na-within">NA within</a></li>
      <li><a href="#na-bwwithin">NA bw/within</a></li>
      <li><a href="#table-of-fps">Table of FPs</a></li>
      <li><a href="#table-of-bias">Table of Bias</a></li>
      </ul>
</li>
      <li>
<a href="#bootstrap-sim-results">Bootstrap Sim Results</a><ul class="nav nav-pills nav-stacked">
<li><a href="#na-parametric">NA parametric</a></li>
      <li><a href="#table-of-fps-1">Table of FPs</a></li>
      <li><a href="#table-of-bias-1">Table of Bias</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
